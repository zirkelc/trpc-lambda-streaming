{"version":3,"file":"httpServerRequest.js","names":["Schema","Channel","Context","Effect","Inspectable","Option","Stream","Cookies","Headers","IncomingMessage","Error","Multipart","Socket","UrlParams","TypeId","Symbol","for","serverRequestTag","GenericTag","parsedSearchParamsTag","upgrade","flatMap","request","upgradeChannel","unwrap","map","toChannelWith","multipartPersisted","multipart","searchParamsFromURL","url","out","key","value","searchParams","entries","entry","undefined","Array","isArray","push","schemaCookies","schema","options","parse","decodeUnknown","req","cookies","schemaHeaders","schemaSearchParams","schemaBodyJson","isMultipart","headers","toLowerCase","includes","schemaBodyForm","parseMultipart","schemaPersisted","parseUrlParams","schemaBodyUrlParams","schemaBodyMultipart","schemaBodyFormJson","schemaJson","field","mapError","cause","RequestError","reason","urlParamsBody","fromWeb","ServerRequestImpl","removeHost","index","indexOf","slice","Class","source","headersOverride","remoteAddressOverride","constructor","toJSON","inspect","_id","method","originalUrl","modify","remoteAddress","toUpperCase","some","none","fromInput","cachedCookies","parseHeader","cookie","stream","body","fromReadableStream","fail","description","textEffect","text","runSync","cached","tryPromise","try","catch","json","tryMap","_","JSON","URLSearchParams","multipartEffect","toPersisted","multipartStream","pipeThroughChannel","MultipartError","makeChannel","arrayBufferEffect","arrayBuffer","toURL","self","host","protocol","URL"],"sources":["../../../src/internal/httpServerRequest.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}