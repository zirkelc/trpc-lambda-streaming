{"version":3,"file":"commandExecutor.js","names":["Command","_interopRequireWildcard","require","CommandExecutor","FileSystem","Deferred","Effect","_Function","Inspectable","Layer","Option","Sink","Stream","ChildProcess","_error","_sink","_stream","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","inputToStdioOption","stdin","outputToStdioOption","output","toError","err","globalThis","Error","String","toPlatformError","method","error","command","flattened","flatten","reduce","acc","curr","args","join","length","handleErrnoException","ProcessProto","ProcessTypeId","BaseProto","toJSON","_id","pid","runCommand","fileSystem","_tag","spawn","flatMap","make","exitCode","async","resume","handle","stdio","stdout","stderr","cwd","getOrElse","constUndefined","shell","env","process","fromEntries","on","fail","unsafeDone","succeed","sync","kill","pipe","match","onNone","void","onSome","dir","access","zipRight","acquireRelease","isDone","done","suspend","await","map","exitCodeDeferred","drain","fromWritable","code","signal","ExitCode","isRunning","negate","asVoid","ProcessId","fromReadable","transduce","assign","create","identity","tap","forkDaemon","run","head","tail","slice","initial","last","stream","unwrapScoped","layer","exports","effect","makeExecutor"],"sources":["../../../src/internal/commandExecutor.ts"],"sourcesContent":[null],"mappings":";;;;;;AAAA,IAAAA,OAAA,GAAAC,uBAAA,CAAAC,OAAA;AACA,IAAAC,eAAA,GAAAF,uBAAA,CAAAC,OAAA;AAEA,IAAAE,UAAA,GAAAH,uBAAA,CAAAC,OAAA;AACA,IAAAG,QAAA,GAAAJ,uBAAA,CAAAC,OAAA;AACA,IAAAI,MAAA,GAAAL,uBAAA,CAAAC,OAAA;AACA,IAAAK,SAAA,GAAAL,OAAA;AACA,IAAAM,WAAA,GAAAP,uBAAA,CAAAC,OAAA;AACA,IAAAO,KAAA,GAAAR,uBAAA,CAAAC,OAAA;AACA,IAAAQ,MAAA,GAAAT,uBAAA,CAAAC,OAAA;AAEA,IAAAS,IAAA,GAAAV,uBAAA,CAAAC,OAAA;AACA,IAAAU,MAAA,GAAAX,uBAAA,CAAAC,OAAA;AACA,IAAAW,YAAA,GAAAZ,uBAAA,CAAAC,OAAA;AACA,IAAAY,MAAA,GAAAZ,OAAA;AACA,IAAAa,KAAA,GAAAb,OAAA;AACA,IAAAc,OAAA,GAAAd,OAAA;AAA0C,SAAAe,yBAAAC,CAAA,6BAAAC,OAAA,mBAAAC,CAAA,OAAAD,OAAA,IAAAE,CAAA,OAAAF,OAAA,YAAAF,wBAAA,YAAAA,CAAAC,CAAA,WAAAA,CAAA,GAAAG,CAAA,GAAAD,CAAA,KAAAF,CAAA;AAAA,SAAAjB,wBAAAiB,CAAA,EAAAE,CAAA,SAAAA,CAAA,IAAAF,CAAA,IAAAA,CAAA,CAAAI,UAAA,SAAAJ,CAAA,eAAAA,CAAA,uBAAAA,CAAA,yBAAAA,CAAA,WAAAK,OAAA,EAAAL,CAAA,QAAAG,CAAA,GAAAJ,wBAAA,CAAAG,CAAA,OAAAC,CAAA,IAAAA,CAAA,CAAAG,GAAA,CAAAN,CAAA,UAAAG,CAAA,CAAAI,GAAA,CAAAP,CAAA,OAAAQ,CAAA,KAAAC,SAAA,UAAAC,CAAA,GAAAC,MAAA,CAAAC,cAAA,IAAAD,MAAA,CAAAE,wBAAA,WAAAC,CAAA,IAAAd,CAAA,oBAAAc,CAAA,OAAAC,cAAA,CAAAC,IAAA,CAAAhB,CAAA,EAAAc,CAAA,SAAAG,CAAA,GAAAP,CAAA,GAAAC,MAAA,CAAAE,wBAAA,CAAAb,CAAA,EAAAc,CAAA,UAAAG,CAAA,KAAAA,CAAA,CAAAV,GAAA,IAAAU,CAAA,CAAAC,GAAA,IAAAP,MAAA,CAAAC,cAAA,CAAAJ,CAAA,EAAAM,CAAA,EAAAG,CAAA,IAAAT,CAAA,CAAAM,CAAA,IAAAd,CAAA,CAAAc,CAAA,YAAAN,CAAA,CAAAH,OAAA,GAAAL,CAAA,EAAAG,CAAA,IAAAA,CAAA,CAAAe,GAAA,CAAAlB,CAAA,EAAAQ,CAAA,GAAAA,CAAA;AAE1C,MAAMW,kBAAkB,GAAIC,KAA4B,IACtD,OAAOA,KAAK,KAAK,QAAQ,GAAGA,KAAK,GAAG,MAAM;AAE5C,MAAMC,mBAAmB,GAAIC,MAA8B,IACzD,OAAOA,MAAM,KAAK,QAAQ,GAAGA,MAAM,GAAG,MAAM;AAE9C,MAAMC,OAAO,GAAIC,GAAY,IAAYA,GAAG,YAAYC,UAAU,CAACC,KAAK,GAAGF,GAAG,GAAG,IAAIC,UAAU,CAACC,KAAK,CAACC,MAAM,CAACH,GAAG,CAAC,CAAC;AAElH,MAAMI,eAAe,GAAGA,CACtBC,MAAc,EACdC,KAA4B,EAC5BC,OAAwB,KACD;EACvB,MAAMC,SAAS,GAAGlD,OAAO,CAACmD,OAAO,CAACF,OAAO,CAAC,CAACG,MAAM,CAAC,CAACC,GAAG,EAAEC,IAAI,KAAI;IAC9D,MAAML,OAAO,GAAG,GAAGK,IAAI,CAACL,OAAO,IAAIK,IAAI,CAACC,IAAI,CAACC,IAAI,CAAC,GAAG,CAAC,EAAE;IACxD,OAAOH,GAAG,CAACI,MAAM,KAAK,CAAC,GAAGR,OAAO,GAAG,GAAGI,GAAG,MAAMJ,OAAO,EAAE;EAC3D,CAAC,EAAE,EAAE,CAAC;EACN,OAAO,IAAAS,2BAAoB,EAAC,SAAS,EAAEX,MAAM,CAAC,CAACC,KAAK,EAAE,CAACE,SAAS,CAAC,CAAC;AACpE,CAAC;AAKD,MAAMS,YAAY,GAAG;EACnB,CAACxD,eAAe,CAACyD,aAAa,GAAGzD,eAAe,CAACyD,aAAa;EAC9D,GAAGpD,WAAW,CAACqD,SAAS;EACxBC,MAAMA,CAAA;IACJ,OAAO;MACLC,GAAG,EAAE,0CAA0C;MAC/CC,GAAG,EAAE,IAAI,CAACA;KACX;EACH;CACD;AAED,MAAMC,UAAU,GACbC,UAAiC,IACjCjB,OAAwB,IAA8E;EACrG,QAAQA,OAAO,CAACkB,IAAI;IAClB,KAAK,iBAAiB;MAAE;QACtB,MAAMC,KAAK,GAAG9D,MAAM,CAAC+D,OAAO,CAC1BhE,QAAQ,CAACiE,IAAI,EAAY,EACxBC,QAAQ,IACPjE,MAAM,CAACkE,KAAK,CACTC,MAAM,IAAI;UACT,MAAMC,MAAM,GAAG7D,YAAY,CAACuD,KAAK,CAACnB,OAAO,CAACA,OAAO,EAAEA,OAAO,CAACM,IAAI,EAAE;YAC/DoB,KAAK,EAAE,CACLtC,kBAAkB,CAACY,OAAO,CAACX,KAAK,CAAC,EACjCC,mBAAmB,CAACU,OAAO,CAAC2B,MAAM,CAAC,EACnCrC,mBAAmB,CAACU,OAAO,CAAC4B,MAAM,CAAC,CACpC;YACDC,GAAG,EAAEpE,MAAM,CAACqE,SAAS,CAAC9B,OAAO,CAAC6B,GAAG,EAAEE,wBAAc,CAAC;YAClDC,KAAK,EAAEhC,OAAO,CAACgC,KAAK;YACpBC,GAAG,EAAE;cAAE,GAAGC,OAAO,CAACD,GAAG;cAAE,GAAGrD,MAAM,CAACuD,WAAW,CAACnC,OAAO,CAACiC,GAAG;YAAC;WAC1D,CAAC;UACFR,MAAM,CAACW,EAAE,CAAC,OAAO,EAAG3C,GAAG,IAAI;YACzB+B,MAAM,CAACnE,MAAM,CAACgF,IAAI,CAACxC,eAAe,CAAC,OAAO,EAAEJ,GAAG,EAAEO,OAAO,CAAC,CAAC,CAAC;UAC7D,CAAC,CAAC;UACFyB,MAAM,CAACW,EAAE,CAAC,MAAM,EAAE,CAAC,GAAG9B,IAAI,KAAI;YAC5BlD,QAAQ,CAACkF,UAAU,CAAChB,QAAQ,EAAEjE,MAAM,CAACkF,OAAO,CAACjC,IAAI,CAAC,CAAC;UACrD,CAAC,CAAC;UACFmB,MAAM,CAACW,EAAE,CAAC,OAAO,EAAE,MAAK;YACtBZ,MAAM,CAACnE,MAAM,CAACkF,OAAO,CAAC,CAACd,MAAM,EAAEH,QAAQ,CAAC,CAAC,CAAC;UAC5C,CAAC,CAAC;UACF,OAAOjE,MAAM,CAACmF,IAAI,CAAC,MAAK;YACtBf,MAAM,CAACgB,IAAI,CAAC,SAAS,CAAC;UACxB,CAAC,CAAC;QACJ,CAAC,CACF,CACJ;QACD,OAAO,IAAAC,cAAI;QACT;QACAjF,MAAM,CAACkF,KAAK,CAAC3C,OAAO,CAAC6B,GAAG,EAAE;UACxBe,MAAM,EAAEA,CAAA,KAAMvF,MAAM,CAACwF,IAAI;UACzBC,MAAM,EAAGC,GAAG,IAAK9B,UAAU,CAAC+B,MAAM,CAACD,GAAG;SACvC,CAAC,EACF1F,MAAM,CAAC4F,QAAQ,CACb5F,MAAM,CAAC6F,cAAc,CACnB/B,KAAK,EACL,CAAC,CAACM,MAAM,EAAEH,QAAQ,CAAC,KACjBjE,MAAM,CAAC+D,OAAO,CAAChE,QAAQ,CAAC+F,MAAM,CAAC7B,QAAQ,CAAC,EAAG8B,IAAI,IAC7CA,IAAI,GAAG/F,MAAM,CAACwF,IAAI,GAAGxF,MAAM,CAACgG,OAAO,CAAC,MAAK;UACvC,IAAI5B,MAAM,CAACgB,IAAI,CAAC,SAAS,CAAC,EAAE;YAC1B,OAAOrF,QAAQ,CAACkG,KAAK,CAAChC,QAAQ,CAAC;UACjC;UACA,OAAOjE,MAAM,CAACwF,IAAI;QACpB,CAAC,CAAC,CAAC,CACR,CACF,EACDxF,MAAM,CAACkG,GAAG,CAAC,CAAC,CAAC9B,MAAM,EAAE+B,gBAAgB,CAAC,KAA6B;UACjE,IAAInE,KAAK,GAAyD3B,IAAI,CAAC+F,KAAK;UAE5E,IAAIhC,MAAM,CAACpC,KAAK,KAAK,IAAI,EAAE;YACzBA,KAAK,GAAG,IAAAqE,kBAAY,EAClB,MAAMjC,MAAM,CAACpC,KAAM,EAClBI,GAAG,IAAKI,eAAe,CAAC,YAAY,EAAEL,OAAO,CAACC,GAAG,CAAC,EAAEO,OAAO,CAAC,CAC9D;UACH;UAEA,MAAMsB,QAAQ,GAAwCjE,MAAM,CAAC+D,OAAO,CAClEhE,QAAQ,CAACkG,KAAK,CAACE,gBAAgB,CAAC,EAChC,CAAC,CAACG,IAAI,EAAEC,MAAM,CAAC,KAAI;YACjB,IAAID,IAAI,KAAK,IAAI,EAAE;cACjB,OAAOtG,MAAM,CAACkF,OAAO,CAACrF,eAAe,CAAC2G,QAAQ,CAACF,IAAI,CAAC,CAAC;YACvD;YACA;YACA;YACA;YACA,OAAOtG,MAAM,CAACgF,IAAI,CAChBxC,eAAe,CACb,UAAU,EACV,IAAIH,UAAU,CAACC,KAAK,CAAC,iDAAiDiE,MAAM,EAAE,CAAC,EAC/E5D,OAAO,CACR,CACF;UACH,CAAC,CACF;UAED,MAAM8D,SAAS,GAAGzG,MAAM,CAAC0G,MAAM,CAAC3G,QAAQ,CAAC+F,MAAM,CAACK,gBAAgB,CAAC,CAAC;UAElE,MAAMf,IAAI,GAAoCA,CAACmB,MAAM,GAAG,SAAS,KAC/DvG,MAAM,CAACgG,OAAO,CAAC,MACb5B,MAAM,CAACgB,IAAI,CAACmB,MAAM,CAAC,GACfvG,MAAM,CAAC2G,MAAM,CAAC5G,QAAQ,CAACkG,KAAK,CAACE,gBAAgB,CAAC,CAAC,GAC/CnG,MAAM,CAACgF,IAAI,CAACxC,eAAe,CAAC,MAAM,EAAE,IAAIH,UAAU,CAACC,KAAK,CAAC,wBAAwB,CAAC,EAAEK,OAAO,CAAC,CAAC,CAClG;UAEH,MAAMe,GAAG,GAAG7D,eAAe,CAAC+G,SAAS,CAACxC,MAAM,CAACV,GAAI,CAAC;UAClD,MAAMa,MAAM,GAAG,IAAAsC,oBAAY,EACzB,MAAMzC,MAAM,CAACG,MAAO,EACnBnC,GAAG,IAAKI,eAAe,CAAC,sBAAsB,EAAEL,OAAO,CAACC,GAAG,CAAC,EAAEO,OAAO,CAAC,CACxE;UACD,IAAI2B,MAAM,GAAmD,IAAAuC,oBAAY,EAIvE,MAAMzC,MAAM,CAACE,MAAO,EACnBlC,GAAG,IAAKI,eAAe,CAAC,sBAAsB,EAAEL,OAAO,CAACC,GAAG,CAAC,EAAEO,OAAO,CAAC,CACxE;UACD;UACA,IAAI,OAAOA,OAAO,CAAC2B,MAAM,KAAK,QAAQ,EAAE;YACtCA,MAAM,GAAGhE,MAAM,CAACwG,SAAS,CAACxC,MAAM,EAAE3B,OAAO,CAAC2B,MAAM,CAAC;UACnD;UACA,OAAO/C,MAAM,CAACwF,MAAM,CAACxF,MAAM,CAACyF,MAAM,CAAC3D,YAAY,CAAC,EAAE;YAChDK,GAAG;YACHO,QAAQ;YACRwC,SAAS;YACTrB,IAAI;YACJpD,KAAK;YACLuC,MAAM;YACND;WACD,CAAC;QACJ,CAAC,CAAC,EACF,OAAO3B,OAAO,CAACX,KAAK,KAAK,QAAQ,GAC7BiF,kBAAQ,GACRjH,MAAM,CAACkH,GAAG,CAAErC,OAAO,IACnB7E,MAAM,CAACmH,UAAU,CAAC7G,MAAM,CAAC8G,GAAG,CAACzE,OAAO,CAACX,KAAkC,EAAE6C,OAAO,CAAC7C,KAAK,CAAC,CAAC,CACzF,CACJ;MACH;IACA,KAAK,cAAc;MAAE;QACnB,MAAMY,SAAS,GAAGlD,OAAO,CAACmD,OAAO,CAACF,OAAO,CAAC;QAC1C,IAAIC,SAAS,CAACO,MAAM,KAAK,CAAC,EAAE;UAC1B,OAAO,IAAAkC,cAAI,EAACzC,SAAS,CAAC,CAAC,CAAC,EAAEe,UAAU,CAACC,UAAU,CAAC,CAAC;QACnD;QACA,MAAMyD,IAAI,GAAGzE,SAAS,CAAC,CAAC,CAAC;QACzB,MAAM0E,IAAI,GAAG1E,SAAS,CAAC2E,KAAK,CAAC,CAAC,CAAC;QAC/B,MAAMC,OAAO,GAAGF,IAAI,CAACC,KAAK,CAAC,CAAC,EAAED,IAAI,CAACnE,MAAM,GAAG,CAAC,CAAC;QAC9C,MAAMsE,IAAI,GAAGH,IAAI,CAACA,IAAI,CAACnE,MAAM,GAAG,CAAC,CAAC;QAClC,MAAMuE,MAAM,GAAGF,OAAO,CAAC1E,MAAM,CAC3B,CAACd,KAAK,EAAEW,OAAO,KACb,IAAA0C,cAAI,EACF3F,OAAO,CAACsC,KAAK,CAACW,OAAO,EAAEX,KAAK,CAAC,EAC7B2B,UAAU,CAACC,UAAU,CAAC,EACtB5D,MAAM,CAACkG,GAAG,CAAErB,OAAO,IAAKA,OAAO,CAACP,MAAM,CAAC,EACvChE,MAAM,CAACqH,YAAY,CACpB,EACH,IAAAtC,cAAI,EACF1B,UAAU,CAACC,UAAU,CAAC,CAACyD,IAAI,CAAC,EAC5BrH,MAAM,CAACkG,GAAG,CAAErB,OAAO,IAAKA,OAAO,CAACP,MAAM,CAAC,EACvChE,MAAM,CAACqH,YAAY,CACpB,CACF;QACD,OAAO,IAAAtC,cAAI,EAAC3F,OAAO,CAACsC,KAAK,CAACyF,IAAI,EAAEC,MAAM,CAAC,EAAE/D,UAAU,CAACC,UAAU,CAAC,CAAC;MAClE;EACF;AACF,CAAC;AAEH;AACO,MAAMgE,KAAK,GAAAC,OAAA,CAAAD,KAAA,gBAA+EzH,KAAK,CAAC2H,MAAM,CAC3GjI,eAAe,CAACA,eAAe,eAC/B,IAAAwF,cAAI,EACFvF,UAAU,CAACA,UAAU,eACrBE,MAAM,CAACkG,GAAG,CAAEtC,UAAU,IAAK/D,eAAe,CAACkI,YAAY,CAACpE,UAAU,CAACC,UAAU,CAAC,CAAC,CAAC,CACjF,CACF","ignoreList":[]}