{"version":3,"file":"httpClient.js","names":["Cookies","_interopRequireWildcard","require","Client","Error","ClientResponse","IncomingMessage","Context","Effect","_Function","Layer","Stream","Http","Https","_nodeStream","_promises","NodeSink","_httpIncomingMessage","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","HttpAgentTypeId","exports","Symbol","for","HttpAgent","GenericTag","makeAgent","options","map","all","acquireRelease","sync","Agent","agent","destroy","http","https","makeAgentLayer","scoped","agentLayer","fromAgent","makeService","request","url","signal","nodeRequest","protocol","method","headers","pipe","zipRight","sendBody","body","waitForResponse","concurrent","_","ClientResponseImpl","suspend","_tag","end","waitForFinish","response","Response","formData","forEach","value","key","setHeader","tryPromise","try","pipeline","Readable","fromWeb","catch","cause","RequestError","reason","run","mapError","stream","fromWritable","async","resume","onError","fail","on","onResponse","off","succeed","once","onFinish","void","HttpIncomingMessageImpl","TypeId","constructor","source","ResponseError","status","statusCode","cachedCookies","cookies","undefined","header","Array","isArray","fromSetCookie","empty","init","globalThis","Headers","statusMessage","statusText","toWeb","toJSON","inspect","_id","make","layerWithoutAgent","layerMergedContext","layer","provide"],"sources":["../../../src/internal/httpClient.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}